import{k as S,f as x,u as y,r as l,j as s,N as h,p as c,w as T,A as E,g,h as b}from"./index-10d7742c.js";import{R as m}from"./index.esm-a921f15a.js";const R={password:"",confirmPassword:"",code:"",isLoading:!1,requestStatus:{isDone:!1,message:""},errors:{confirmPassword:"",password:"",code:""}};function j(a,r){switch(r.type){case"SET_CONFIRM_PASSWORD":return{...a,confirmPassword:r.payload};case"SET_PASSWORD":return{...a,password:r.payload};case"SET_CODE":return{...a,code:r.payload};case"SET_OTP":return{...a,password:r.payload};case"SET_LOADING":return{...a,isLoading:r.payload};case"SET_REQUEST_STATUS":return{...a,requestStatus:r.payload};case"SET_ERRORS":return{...a,errors:r.payload};default:return a}}const P=()=>{var u;const a=S(),{user:r}=x(),p=y(),[e,o]=l.useReducer(j,R),n=t=>{const{name:i,value:d}=t.target;switch(i){case"confirm password":o({type:"SET_CONFIRM_PASSWORD",payload:d});break;case"password":o({type:"SET_PASSWORD",payload:d});break;case"otp code":o({type:"SET_CODE",payload:d});break}},w=()=>{let t={confirmPassword:"",password:"",code:""};return t.password=e.password===""?"This field is required":/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/.test(e.password)?"":"password format is not valid",t.confirmPassword=e.confirmPassword===""?"This field is required":/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/.test(e.confirmPassword)?"":e.password!==e.confirmPassword?"There is no match for the password":"password format is not valid",t.code=e.code===""?"This field is required":e.code.length!==4?"password format is not valid":isNaN(+e.code)?"The field must contain numbers only":"",o({type:"SET_ERRORS",payload:t}),Object.values(t).every(i=>i==="")},f=async t=>{var i;if(t.preventDefault(),o({type:"SET_ERRORS",payload:{email:"",password:"",code:""}}),o({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:""}}),w())try{o({type:"SET_LOADING",payload:!0});const d={email:(i=p.state)==null?void 0:i.email,password:e.password,confirm_password:e.password,code:e.code};await g.post(`${b}/api/auth/new-password`,d),a("/account/login",{replace:!0})}catch(d){d.response?o({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:d.response.data.message}}):o({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:"Please check your internet connection"}})}finally{o({type:"SET_LOADING",payload:!1})}};return l.useEffect(()=>{window.scrollTo(0,0)},[]),Object.keys(r).length!==0||!((u=p.state)!=null&&u.email)?s.jsx(h,{to:"/",replace:!0}):s.jsxs(l.Fragment,{children:[s.jsx("div",{className:"text-center mb-10",children:s.jsx("h2",{className:"font-bold text-3xl text-gray-900 capitalize",children:"set new password"})}),e.requestStatus.isDone?s.jsx("p",{className:"text-red-600 text-center text-lg",children:e.requestStatus.message}):null,s.jsxs("form",{onSubmit:f,children:[s.jsx(c,{label:"password",placeholder:"************",value:e.password,onChange:n,isPassword:!0,Icon:s.jsx(m,{}),error:e.errors.password}),s.jsx(c,{label:"confirm password",placeholder:"************",value:e.confirmPassword,onChange:n,isPassword:!0,Icon:s.jsx(m,{}),error:e.errors.confirmPassword}),s.jsx("div",{className:"mb-5",children:s.jsx(c,{label:"otp code",placeholder:"",value:e.code,onChange:n,isPassword:!1,Icon:s.jsx(T,{}),error:e.errors.code})}),s.jsxs("div",{className:"flex flex-col justify-center items-center -mx-3",children:[s.jsx("div",{}),s.jsx("div",{className:"w-full px-3 mb-5",children:s.jsx("button",{type:"submit",disabled:e.isLoading,className:`flex justify-center items-center w-full max-w-xs text-2xl uppercase mx-auto bg-primary hover:bg-primary/80 disabled:cursor-wait\r
           disabled:bg-primary/80 transition-all duration-300 hover:scale-105 disabled:hover:scale-100 text-white rounded-lg px-3 py-2 font-semibold`,children:e.isLoading?s.jsx(E,{className:"text-4xl text-center animate-spin"}):"reset"})})]})]})]})};export{P as default};
