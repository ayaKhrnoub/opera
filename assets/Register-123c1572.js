import{r as f,h,e as S,j as a,N,R as y,p as i,q as n,t as x,v as T,A as E,f as w,g as b}from"./index-a5b3392c.js";import{R as d}from"./index.esm-8107d207.js";const _={firstName:"",lastName:"",phoneNumber:"",password:"",email:"",confirmPassword:"",isLoading:!1,requestStatus:{isDone:!1,message:""},errors:{firstName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}};function g(e,s){switch(s.type){case"SET_FIRST_NAME":return{...e,firstName:s.payload};case"SET_EMAIL":return{...e,email:s.payload};case"SET_LAST_NAME":return{...e,lastName:s.payload};case"SET_PHONE_NUMBER":return{...e,phoneNumber:s.payload};case"SET_PASSWORD":return{...e,password:s.payload};case"SET_CONFIRM_PASSWORD":return{...e,confirmPassword:s.payload};case"SET_LOADING":return{...e,isLoading:s.payload};case"SET_REQUEST_STATUS":return{...e,requestStatus:s.payload};case"SET_ERRORS":return{...e,errors:s.payload};default:return e}}const A=()=>{const[e,s]=f.useReducer(g,_),m=h(),{user:p}=S(),c=async r=>{if(r.preventDefault(),s({type:"SET_REQUEST_STATUS",payload:{isDone:!1,message:""}}),s({type:"SET_ERRORS",payload:{firstName:"",lastName:"",phoneNumber:"",password:"",confirmPassword:"",email:""}}),u())try{s({type:"SET_LOADING",payload:!0});const t={first_name:e.firstName,last_name:e.lastName,phone_number:e.phoneNumber,email:e.email,password:e.password,c_password:e.confirmPassword};await w.post(`${b}/api/auth/register`,t),m("/account/verify",{replace:!0,state:{email:e.email}})}catch(t){t.response?t.response.status===500?s({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:"The phone number, email or username has already been taken"}}):s({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:JSON.stringify(t.response.data.message)}}):s({type:"SET_REQUEST_STATUS",payload:{isDone:!0,message:"Please check your internet connection"}})}finally{s({type:"SET_LOADING",payload:!1})}},o=r=>{const{name:t,value:l}=r.target;switch(t){case"first name":s({type:"SET_FIRST_NAME",payload:l});break;case"last name":s({type:"SET_LAST_NAME",payload:l});break;case"phone number":s({type:"SET_PHONE_NUMBER",payload:l});break;case"email":s({type:"SET_EMAIL",payload:l});break;case"password":s({type:"SET_PASSWORD",payload:l});break;case"confirm password":s({type:"SET_CONFIRM_PASSWORD",payload:l});break}},u=()=>{let r={firstName:"",lastName:"",phoneNumber:"",password:"",confirmPassword:"",username:""};return r.firstName=e.firstName?"":"This field is required",r.lastName=e.lastName?"":"This field is required",r.phoneNumber=e.phoneNumber===""?"This field is required":/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/.test(e.phoneNumber)?"":"phone number format is not valid",r.password=e.password===""?"This field is required":/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/.test(e.password)?"":"password format is not valid",r.confirmPassword=e.confirmPassword===""?"This field is required":e.confirmPassword===e.password?"":"There is no match for the password",r.email=e.email===""?"This field is required":/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)?"":"email format is not valid",s({type:"SET_ERRORS",payload:r}),Object.values(r).every(t=>t==="")};return Object.keys(p).length!==0?a.jsx(N,{to:"/",replace:!0}):a.jsxs(y.Fragment,{children:[a.jsx("div",{className:"text-center mb-5",children:a.jsx("h2",{className:"font-bold text-3xl text-gray-900 capitalize",children:"create new account"})}),e.requestStatus.isDone?a.jsx("p",{className:"text-red-600 text-center text-lg",children:e.requestStatus.message}):null,a.jsxs("form",{onSubmit:c,children:[a.jsxs("div",{className:"flex justify-center items-center gap-4",children:[a.jsx(i,{label:"first name",placeholder:"",value:e.firstName,onChange:o,isPassword:!1,Icon:a.jsx(n,{}),error:e.errors.firstName}),a.jsx(i,{label:"last name",placeholder:"",value:e.lastName,onChange:o,isPassword:!1,Icon:a.jsx(n,{}),error:e.errors.lastName})]}),a.jsx(i,{label:"email",placeholder:"",value:e.email,onChange:o,isPassword:!1,Icon:a.jsx(x,{}),error:e.errors.email}),a.jsx(i,{label:"phone number",placeholder:"",value:e.phoneNumber,onChange:o,isPassword:!1,Icon:a.jsx(T,{}),error:e.errors.phoneNumber}),a.jsx(i,{label:"password",placeholder:"",value:e.password,onChange:o,isPassword:!0,Icon:a.jsx(d,{}),error:e.errors.password}),a.jsx(i,{label:"confirm password",placeholder:"",value:e.confirmPassword,onChange:o,isPassword:!0,Icon:a.jsx(d,{}),error:e.errors.confirmPassword}),a.jsx("div",{className:"flex mt-4 flex-col justify-center items-center",children:a.jsx("div",{className:"w-full px-3 mb-2",children:a.jsx("button",{type:"submit",disabled:e.isLoading,className:"flex justify-center items-center w-full max-w-xs text-2xl uppercase mx-auto bg-primary hover:bg-primary/80 transition-all duration-300 hover:scale-105 text-white rounded-lg px-3 py-2 font-semibold",children:e.isLoading?a.jsx(E,{className:"text-4xl text-center animate-spin"}):a.jsx("span",{children:"register"})})})})]})]})};export{A as default};
